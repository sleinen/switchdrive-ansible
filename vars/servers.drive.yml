---

#####################
# networks
os_network: "drive"

#####################
# server groups
os_server_group:
  list:
    - { name: "load_balancers", policies: ['anti-affinity'] }
    - { name: "redis",          policies: ['anti-affinity'] }
    - { name: "grahite",        policies: ['anti-affinity'] }
    - { name: "elk",            policies: ['anti-affinity'] }
  # look up id after they were created: `openstack server group list`
  load_balancers: "49b089f0-7987-4d7e-843c-0818efbaaa38"
  redis:          "812b5d3c-bce7-423c-9ce9-aea3fd356376"

#####################
# servers
os_server:
  lb1:        { ip: "{{ hostvars[groups['lb'][0]].inventory_hostname}}",        flavor: "drive-40-4-4", image: "{{os_image['xenial']}}", root_size: "20", security_groups: "default,development,ldap,web", hints: { group: "{{ os_server_group['load_balancers'] }}" } }
  lb2:        { ip: "{{ hostvars[groups['lb'][1]].inventory_hostname}}",        flavor: "drive-40-4-4", image: "{{os_image['xenial']}}", root_size: "20", security_groups: "default,development,ldap,web", hints: { group: "{{ os_server_group['load_balancers'] }}" } }

  redis1:     { ip: "{{ hostvars[groups['redis'][0]].inventory_hostname}}",     flavor: "drive-40-4-4", image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default",                      hints: { group: "{{ os_server_group['redis'] }}" } }
  redis2:     { ip: "{{ hostvars[groups['redis'][1]].inventory_hostname}}",     flavor: "drive-40-4-4", image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default",                      hints: { group: "{{ os_server_group['redis'] }}" } }

  web11:      { ip: "{{ hostvars[groups['web'][11]].inventory_hostname}}",      flavor: "drive-40-4-4", image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default", hints: {} }
  web12:      { ip: "{{ hostvars[groups['web'][11]].inventory_hostname}}",      flavor: "drive-40-4-4", image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default", hints: {} }
  web13:      { ip: "{{ hostvars[groups['web'][11]].inventory_hostname}}",      flavor: "drive-40-4-4", image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default", hints: {} }
  web14:      { ip: "{{ hostvars[groups['web'][11]].inventory_hostname}}",      flavor: "drive-40-4-4", image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default", hints: {} }

  sync11:     { ip: "{{ hostvars[groups['sync'][11]].inventory_hostname}}",     flavor: "c1.xxlarge",   image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default", hints: {} }
  sync12:     { ip: "{{ hostvars[groups['sync'][11]].inventory_hostname}}",     flavor: "c1.xxlarge",   image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default", hints: {} }
  sync13:     { ip: "{{ hostvars[groups['sync'][11]].inventory_hostname}}",     flavor: "c1.xxlarge",   image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default", hints: {} }
  sync14:     { ip: "{{ hostvars[groups['sync'][11]].inventory_hostname}}",     flavor: "c1.xxlarge",   image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default", hints: {} }

  grahite1:   { ip: "{{ hostvars[groups['graphite'][0]].inventory_hostname}}",  flavor: "drive-40-4-4", image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default",                      hints: { group: "{{ os_server_group['graphite'] }}" } }
  grahite2:   { ip: "{{ hostvars[groups['graphite'][0]].inventory_hostname}}",  flavor: "drive-40-4-4", image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default",                      hints: { group: "{{ os_server_group['graphite'] }}" } }
  elk1:       { ip: "{{ hostvars[groups['elk'][0]].inventory_hostname}}",       flavor: "c1.xxlarge",   image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default",                      hints: { group: "{{ os_server_group['elk'] }}" } }
  elk2:       { ip: "{{ hostvars[groups['elk'][0]].inventory_hostname}}",       flavor: "c1.xxlarge",   image: "{{os_image['xenial']}}", root_size: "40", security_groups: "default",                      hints: { group: "{{ os_server_group['elk'] }}" } }

#####################
# vips

# use `openstack port list` to find ports
# verify settings with: `openstack port show <port>`

os_vip:
  ips:
    - { name: "lb_vip1", ip: "{{ hostvars[groups['lb_vip'][0]].inventory_hostname }}" }
    - { name: "lb_vip2", ip: "{{ hostvars[groups['lb_vip'][1]].inventory_hostname }}" }
  ports:
    - { name: '{{ site }}-lb1-port_{{ os_network }}', ips: [ { ip_address: "{{ hostvars[groups['lb_vip'][0]].inventory_hostname }}" }, { ip_address: "{{ hostvars[groups['lb_vip'][1]].inventory_hostname }}" } ] }
    - { name: '{{ site }}-lb2-port_{{ os_network }}', ips: [ { ip_address: "{{ hostvars[groups['lb_vip'][0]].inventory_hostname }}" }, { ip_address: "{{ hostvars[groups['lb_vip'][1]].inventory_hostname }}" } ] }
